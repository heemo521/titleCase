<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Document</title>
    </head>
    <body>
        <script>
            /* 
            How to implement title case 
            
            In title case, capitalize the following words in a title or heading:
              1. the first word of the title or heading, even if it is a minor word such as “The” or “A” the first word of a subtitle
              2. the first word after a colon, em dash, or end punctuation in a heading
              3. major words, including the second part of hyphenated major words (e.g., “Self-Report,” not “Self-report”) 
              4. words of four letters or more (e.g., “With,” “Between,” “From”)
            
            Lowercase only minor words that are:
              1. Three letters or fewer in a title or heading, except the first word in a title or subtitle or the first word after a colon, em dash, or end punctuation in a heading
              ex) short conjunctions (e.g., “and,” “as,” “but,” “for,” “if,” “nor,” “or,” “so,” “yet”)
              ex) articles (“a,” “an,” “the”)
              ex) short prepositions (e.g., “as,” “at,” “by,” “for,” “in,” “of,” “off,” “on,” “per,” “to,” “up,” “via”) 
            
              Reference: 
              https://apastyle.apa.org/style-grammar-guidelines/capitalization/title-case
              */

            /* NOTE:
              - This is NOT true title case!
              - Use combination 
              - If a word ends with a specialCase, next word should be capitalize. Rule #2
              - Use exceptions for lowercase
                - If true, check if the word is the first word after the specialCase
              
              */
            const convertTitleCase = function (title) {
                const capitalize = (str) => str[0].toUpperCase() + str.slice(1);
                const lowerCase = (str) => str[0].toLowerCase() + str.slice(1);
                const specialCase = [';', '-', ':', ','];
                // const exceptions = ['a', 'an', 'and', 'the', 'but', 'or', 'on', 'in', 'with'];

                let foundC = false;
                let foundI = 10;

                let newWords = title
                    .toLowerCase()
                    .split(' ')
                    .map((word) => word.split(''))
                    .map((arr1) => {
                        let newArray = arr1
                            .map((arr) => {
                                if (specialCase.includes(arr)) {
                                    foundC = !foundC;
                                    let num = arr1.indexOf(arr);
                                    if (num < 4) {
                                        foundI = num;
                                    }
                                    return arr;
                                } else if (foundC) {
                                    foundC = !foundC;
                                    return arr.toUpperCase();
                                } else {
                                    return arr;
                                }
                            })
                            .join('');
                        newArray = newArray.length <= 3 ? newArray : capitalize(newArray);
                        newArray = foundI <= 3 ? lowerCase(newArray) : newArray;
                        console.log(foundI < 4 ? `${foundI}: ${newArray}` : `${foundI}: ${newArray}`);
                        foundI = 10;
                        foundC = false;
                        return newArray;
                    })
                    .join(' ');
                return capitalize(newWords);
            };

            // Test Data:
            // console.log(convertTitleCase('this is A some title'));
            // console.log(convertTitleCase('this is A-LONG title-but not-to; :lon'));
            // console.log(convertTitleCase('an here is another title ;with; an! EXAMPLE'));
        </script>
        <!-- <script src='script.js'></script> -->
    </body>
</html>
